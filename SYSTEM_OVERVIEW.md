# üìñ –ü–æ–ª–Ω–æ–µ –æ–ø–∏—Å–∞–Ω–∏–µ —Å–∏—Å—Ç–µ–º—ã Telegram Dating Mini App

**–î–∞—Ç–∞ —Å–æ–∑–¥–∞–Ω–∏—è:** 2024-12-02  
**–í–µ—Ä—Å–∏—è:** 1.0.0

---

## üéØ –û–±—â–µ–µ –æ–ø–∏—Å–∞–Ω–∏–µ –ø—Ä–æ–µ–∫—Ç–∞

**Telegram Dating Mini App** ‚Äî —ç—Ç–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –¥–ª—è –∑–Ω–∞–∫–æ–º—Å—Ç–≤, —Ä–∞–±–æ—Ç–∞—é—â–µ–µ –≤–Ω—É—Ç—Ä–∏ Telegram WebView. –°–∏—Å—Ç–µ–º–∞ –ø–æ—Å—Ç—Ä–æ–µ–Ω–∞ –Ω–∞ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–æ–π –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–µ —Å –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ–º Yandex Cloud —Å–µ—Ä–≤–∏—Å–æ–≤.

### –û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:

- –°–æ–∑–¥–∞–Ω–∏–µ –ø—Ä–æ—Ñ–∏–ª–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –£—á–∞—Å—Ç–∏–µ –≤ —Å–æ–±—ã—Ç–∏—è—Ö
- –õ–∞–π–∫–∏ –∏ –º–∞—Ç—á–∏ –º–µ–∂–¥—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- –û–±–º–µ–Ω —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏
- –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∏
- Telegram –±–æ—Ç –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

---

## üèóÔ∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞ –ø—Ä–æ–µ–∫—Ç–∞

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è

–ü—Ä–æ–µ–∫—Ç –æ—Ä–≥–∞–Ω–∏–∑–æ–≤–∞–Ω –∫–∞–∫ **npm workspaces** –º–æ–Ω–æ—Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π:

```
lug/
‚îú‚îÄ‚îÄ frontend/      # Telegram Web App (React + TypeScript)
‚îú‚îÄ‚îÄ backend/       # API —Å–µ—Ä–≤–µ—Ä (Express + TypeScript)
‚îú‚îÄ‚îÄ bot/           # Telegram –±–æ—Ç (Telegraf)
‚îú‚îÄ‚îÄ admin/         # –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å (React + TypeScript)
‚îú‚îÄ‚îÄ shared/         # –û–±—â–∏–µ TypeScript —Ç–∏–ø—ã
‚îú‚îÄ‚îÄ scripts/        # –£—Ç–∏–ª–∏—Ç—ã –∏ —Å–∫—Ä–∏–ø—Ç—ã
‚îî‚îÄ‚îÄ docs/           # –î–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
```

### –¢–µ—Ö–Ω–æ–ª–æ–≥–∏—á–µ—Å–∫–∏–π —Å—Ç–µ–∫

**Frontend:**

- React 18 + TypeScript
- Vite (—Å–±–æ—Ä–∫–∞)
- React Router v6 (—Ä–æ—É—Ç–∏–Ω–≥)
- TanStack Query v5 (–∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –∏ –∑–∞–ø—Ä–æ—Å—ã)
- Zustand (—Å—Ç–µ–π—Ç-–º–µ–Ω–µ–¥–∂–º–µ–Ω—Ç)
- react-i18next (–∏–Ω—Ç–µ—Ä–Ω–∞—Ü–∏–æ–Ω–∞–ª–∏–∑–∞—Ü–∏—è)
- CSS Modules (—Å—Ç–∏–ª–∏)
- Design System –∏–∑ Figma (381 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç)

**Backend:**

- Node.js 20+ + Express + TypeScript
- YDB SDK v5.11.1 (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö)
- Sharp (–æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π)
- Pino (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ)
- Zod (–≤–∞–ª–∏–¥–∞—Ü–∏—è)
- Multer (–∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤)
- Helmet (–±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å)
- CORS (–∫—Ä–æ—Å—Å-–¥–æ–º–µ–Ω–Ω—ã–µ –∑–∞–ø—Ä–æ—Å—ã)

**Bot:**

- Telegraf (Telegram Bot API)

**Infrastructure:**

- Yandex Managed Service for YDB (–±–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö, serverless)
- Yandex Object Storage (—Ñ–∞–π–ª—ã –∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è)
- Yandex Cloud Functions / Containers (backend)
- Yandex CDN (—Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–π –∫–æ–Ω—Ç–µ–Ω—Ç)
- Yandex Cloud Logging (–ª–æ–≥–∏)
- Catcher / Yandex AppMetrica (–º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –æ—à–∏–±–æ–∫)

---

## üîÑ –ö–∞–∫ —Ä–∞–±–æ—Ç–∞–µ—Ç —Å–∏—Å—Ç–µ–º–∞

### 1. Frontend (Telegram Web App)

#### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (`frontend/src/main.tsx`)

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:**
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
   - –ù–∞—Å—Ç—Ä–æ–π–∫–∞ QueryClient –¥–ª—è TanStack Query
   - –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ Error Monitoring (Yandex AppMetrica)
   - –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Yandex Metrica
   - –í dev —Ä–µ–∂–∏–º–µ: –∑–∞–≥—Ä—É–∑–∫–∞ Eruda (–∫–æ–Ω—Å–æ–ª—å –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö)

2. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Telegram WebApp:**

   ```typescript
   window.Telegram.WebApp.ready();
   window.Telegram.WebApp.expand();
   ```

3. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–æ–≤–∞–π–¥–µ—Ä–æ–≤:**
   - QueryClientProvider (React Query)
   - BrowserRouter (React Router)
   - ErrorBoundary (–æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫)

#### –†–æ—É—Ç–∏–Ω–≥ (`frontend/src/App.tsx`)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ —Å—Ç—Ä–∞–Ω–∏—Ü:**

- `/onboarding` ‚Äî –æ–Ω–±–æ—Ä–¥–∏–Ω–≥ –¥–ª—è –Ω–æ–≤—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `/registration` ‚Äî —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è
- `/` ‚Äî –≥–ª–∞–≤–Ω–∞—è —Å—Ç—Ä–∞–Ω–∏—Ü–∞ (–ª–µ–Ω—Ç–∞ —Å–æ–±—ã—Ç–∏–π)
- `/profile` ‚Äî –ø—Ä–æ—Ñ–∏–ª—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `/matches` ‚Äî —Å–ø–∏—Å–æ–∫ –º–∞—Ç—á–µ–π
- `/saved` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- `/notifications` ‚Äî —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è

**–ó–∞—â–∏—Ç–∞ —Ä–æ—É—Ç–æ–≤:**

- `RegistrationGuard` ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –∑–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å
- `OnboardingGuard` ‚Äî –ø—Ä–æ–≤–µ—Ä—è–µ—Ç, –ø—Ä–æ—à–µ–ª –ª–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –æ–Ω–±–æ—Ä–¥–∏–Ω–≥
- –†–µ–¥–∏—Ä–µ–∫—Ç –Ω–∞ `/onboarding` –µ—Å–ª–∏ –Ω–µ –ø—Ä–æ–π–¥–µ–Ω

#### API –∫–ª–∏–µ–Ω—Ç (`frontend/src/api/client.ts`)

**–ö–ª–∞—Å—Å ApiClient:**

- –¶–µ–Ω—Ç—Ä–∞–ª–∏–∑–æ–≤–∞–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –≤—Å–µ—Ö API –∑–∞–ø—Ä–æ—Å–æ–≤
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Telegram `initData`
- Retry –ª–æ–≥–∏–∫–∞ —Å exponential backoff
- –û–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫ (401, 403, 404, 429, 500)
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ (multipart/form-data)

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**

```typescript
// –ü–æ–ª—É—á–µ–Ω–∏–µ initData –∏–∑ Telegram WebApp
const initData = window.Telegram.WebApp.initData;

// –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –≤ –∑–∞–≥–æ–ª–æ–≤–æ–∫
headers['Authorization'] = `Bearer ${initData}`;
```

**–ú–µ—Ç–æ–¥—ã:**

- `get<T>()` ‚Äî GET –∑–∞–ø—Ä–æ—Å—ã
- `post<T>()` ‚Äî POST –∑–∞–ø—Ä–æ—Å—ã
- `put<T>()` ‚Äî PUT –∑–∞–ø—Ä–æ—Å—ã
- `patch<T>()` ‚Äî PATCH –∑–∞–ø—Ä–æ—Å—ã
- `delete<T>()` ‚Äî DELETE –∑–∞–ø—Ä–æ—Å—ã
- `upload<T>()` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤

#### State Management (Zustand)

**Stores (`frontend/src/stores/`):**

- `userStore.ts` ‚Äî –¥–∞–Ω–Ω—ã–µ —Ç–µ–∫—É—â–µ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `matchesStore.ts` ‚Äî —Å–ø–∏—Å–æ–∫ –º–∞—Ç—á–µ–π
- `eventsStore.ts` ‚Äî —Å–æ–±—ã—Ç–∏—è
- `onboardingStore.ts` ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏–µ –æ–Ω–±–æ—Ä–¥–∏–Ω–≥–∞
- `registrationStore.ts` ‚Äî —Å–æ—Å—Ç–æ—è–Ω–∏–µ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏

#### Design System

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ (`frontend/src/design-system/`):**

- 381 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–∑ Figma
- –¢–æ–∫–µ–Ω—ã –¥–∏–∑–∞–π–Ω-—Å–∏—Å—Ç–µ–º—ã (colors, typography, spacing, radius, shadows)
- CSS Variables –¥–ª—è —Ç–µ–º–Ω–æ–π/—Å–≤–µ—Ç–ª–æ–π —Ç–µ–º—ã
- CSS Modules –¥–ª—è –∫–∞–∂–¥–æ–≥–æ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–∞

**–ò–º–ø–æ—Ä—Ç –∏–∑ Figma:**

```bash
npm run import:figma      # –ü–æ–ª–Ω—ã–π –∏–º–ø–æ—Ä—Ç
npm run sync:figma        # –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∞—Ü–∏—è –∏–∑–º–µ–Ω–µ–Ω–∏–π
```

---

### 2. Backend API

#### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (`backend/src/index.ts`)

**–ü–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—É—Å–∫–∞:**

1. **–ó–∞–≥—Ä—É–∑–∫–∞ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è:**

   ```typescript
   dotenv.config({ path: resolve(process.cwd(), '.env') });
   ```

2. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥–∞:**
   - Yandex Cloud Logging
   - Catcher (error tracking)

3. **–ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ YDB:**

   ```typescript
   await initYDB();
   await runMigrations();
   ```

   - –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—É—Å–∫ —Å–µ—Ä–≤–µ—Ä–∞ –ø—Ä–∏ –æ—à–∏–±–∫–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
   - Health check –ø–æ–∫–∞–∂–µ—Ç —Å—Ç–∞—Ç—É—Å –ë–î

4. **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è Object Storage:**

   ```typescript
   initObjectStorage();
   ```

5. **–ù–∞—Å—Ç—Ä–æ–π–∫–∞ Express:**
   - Helmet (security headers)
   - CORS (–Ω–∞—Å—Ç—Ä–æ–π–∫–∞ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã—Ö origins)
   - Rate Limiting (–∑–∞—â–∏—Ç–∞ –æ—Ç DDoS)
   - Body Parser (JSON)
   - Sanitize Middleware (–∑–∞—â–∏—Ç–∞ –æ—Ç XSS)
   - Request Logger (–ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤)

#### Middleware Pipeline

**–ü–æ—Ä—è–¥–æ–∫ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è:**

1. **Request Logger** (`middleware/requestLogger.ts`)
   - –õ–æ–≥–∏—Ä—É–µ—Ç –≤—Å–µ –≤—Ö–æ–¥—è—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Pino –¥–ª—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–≥–æ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏—è

2. **CORS** (`index.ts`)
   - –ü—Ä–æ–≤–µ—Ä—è–µ—Ç origin –∑–∞–ø—Ä–æ—Å–∞
   - –†–∞–∑—Ä–µ—à–∞–µ—Ç origins –∏–∑ `ALLOWED_ORIGINS` –∏ `ADMIN_ORIGINS`
   - –í development —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –≤—Å–µ origins
   - –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –æ–±—Ä–∞–±–∞—Ç—ã–≤–∞–µ—Ç OPTIONS preflight –∑–∞–ø—Ä–æ—Å—ã

3. **Rate Limiting** (`middleware/rateLimiter.ts`)
   - `generalLimiter` ‚Äî –¥–ª—è –≤—Å–µ—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (100 req/15min)
   - `adminLimiter` ‚Äî –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–∏—Ö –∑–∞–ø—Ä–æ—Å–æ–≤ (50 req/15min)
   - `uploadLimiter` ‚Äî –¥–ª—è –∑–∞–≥—Ä—É–∑–∫–∏ —Ñ–∞–π–ª–æ–≤ (10 req/15min)
   - –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç OPTIONS –∑–∞–ø—Ä–æ—Å—ã

4. **Body Parser**
   - –ü–∞—Ä—Å–∏—Ç JSON —Ç–µ–ª–∞ –∑–∞–ø—Ä–æ—Å–æ–≤
   - –†–∞–∑—Ä–µ—à–∞–µ—Ç –ø—É—Å—Ç—ã–µ JSON —Ç–µ–ª–∞

5. **Sanitize Middleware** (`utils/sanitize.ts`)
   - –û—á–∏—â–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –≤–≤–æ–¥ –æ—Ç XSS
   - –ò—Å–ø–æ–ª—å–∑—É–µ—Ç DOMPurify
   - –ü—Ä–æ–ø—É—Å–∫–∞–µ—Ç GET –∏ OPTIONS –∑–∞–ø—Ä–æ—Å—ã

6. **Authentication Middleware**
   - `telegramAuthMiddleware` ‚Äî –¥–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö API
   - `adminAuthMiddleware` ‚Äî –¥–ª—è –∞–¥–º–∏–Ω—Å–∫–∏—Ö API

#### –†–æ—É—Ç—ã (`backend/src/routes/`)

**–ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ API (`/api/v1`):**

- `/api/v1/matches` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –∏ –ø–æ–ª—É—á–µ–Ω–∏–µ –º–∞—Ç—á–µ–π
- `/api/v1/photos` ‚Äî –∑–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–π
- `/api/v1/feed` ‚Äî –ª–µ–Ω—Ç–∞ —Å–æ–±—ã—Ç–∏–π
- `/api/v1/saved-events` ‚Äî —Å–æ—Ö—Ä–∞–Ω–µ–Ω–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è
- `/api/v1/notifications` ‚Äî —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è
- `/api/v1/user` ‚Äî –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- `/api/v1/events` ‚Äî —Å–æ–±—ã—Ç–∏—è

**–ê–¥–º–∏–Ω—Å–∫–∏–µ API (`/api/admin`):**

- `/api/admin/auth` ‚Äî –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è –∞–¥–º–∏–Ω–∞ (login/logout)
- `/api/admin/analytics/*` ‚Äî –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ (6 endpoints)
- `/api/admin/management/*` ‚Äî —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ (–ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏, —Å–æ–±—ã—Ç–∏—è)

**–í—Å–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–µ —Ä–æ—É—Ç—ã —Ç—Ä–µ–±—É—é—Ç:**

- `telegramAuthMiddleware` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ Telegram initData

**–í—Å–µ –∞–¥–º–∏–Ω—Å–∫–∏–µ —Ä–æ—É—Ç—ã —Ç—Ä–µ–±—É—é—Ç:**

- `adminAuthMiddleware` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ JWT —Ç–æ–∫–µ–Ω–∞ –∞–¥–º–∏–Ω–∞

#### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

**Telegram Auth (`middleware/telegramAuth.ts`):**

1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ `initData` –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Authorization: Bearer <initData>`
2. –í–∞–ª–∏–¥–∞—Ü–∏—è –ø–æ–¥–ø–∏—Å–∏ —á–µ—Ä–µ–∑ Telegram Bot API
3. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
4. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ `req.telegramUser`

**Admin Auth (`middleware/adminAuth.ts`):**

1. –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –∏–∑ –∑–∞–≥–æ–ª–æ–≤–∫–∞ `Authorization: Bearer <token>`
2. –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ —á–µ—Ä–µ–∑ JWT
3. –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞

#### –†–∞–±–æ—Ç–∞ —Å –±–∞–∑–æ–π –¥–∞–Ω–Ω—ã—Ö

**YDB Connection (`db/connection.ts`):**

**–ö–ª–∞—Å—Å YDBClient:**

- Singleton –ø–∞—Ç—Ç–µ—Ä–Ω
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ –ø–µ—Ä–≤–æ–º –∑–∞–ø—Ä–æ—Å–µ
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –Ω–µ—Å–∫–æ–ª—å–∫–∏—Ö —Å–ø–æ—Å–æ–±–æ–≤ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏:
  - `YC_SERVICE_ACCOUNT_KEY_FILE` (—Ñ–∞–π–ª)
  - `YC_SERVICE_ACCOUNT_KEY` (JSON —Å—Ç—Ä–æ–∫–∞)
  - `YC_SERVICE_ACCOUNT_KEY_B64` (base64)
  - `YDB_TOKEN` (—Ç–æ–∫–µ–Ω)
  - Metadata service (–≤ Yandex Cloud)

**–ú–µ—Ç–æ–¥—ã:**

- `connect()` ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ YDB
- `executeQuery<T>()` ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ –∑–∞–ø—Ä–æ—Å–∞
- `executeTransaction<T>()` ‚Äî –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–µ —Ç—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏
- `getConnectionStatus()` ‚Äî –ø—Ä–æ–≤–µ—Ä–∫–∞ —Å—Ç–∞—Ç—É—Å–∞

**–°—Ö–µ–º–∞ –ë–î (`db/schema.ts`):**

**–¢–∞–±–ª–∏—Ü—ã:**

- `users` ‚Äî –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–∏
- `events` ‚Äî —Å–æ–±—ã—Ç–∏—è
- `matches` ‚Äî –º–∞—Ç—á–∏
- `likes` ‚Äî –ª–∞–π–∫–∏
- `messages` ‚Äî —Å–æ–æ–±—â–µ–Ω–∏—è

**–ú–∏–≥—Ä–∞—Ü–∏–∏ (`db/migrations/`):**

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ —Å–µ—Ä–≤–µ—Ä–∞
- –°–∏—Å—Ç–µ–º–∞ –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –º–∏–≥—Ä–∞—Ü–∏–π
- –ö–æ–º–∞–Ω–¥—ã: `npm run migrate`, `npm run migrate:status`

**–†–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ (`repositories/`):**

- `userRepository.ts` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏
- `matchRepository.ts` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –º–∞—Ç—á–∞–º–∏
- `likeRepository.ts` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å –ª–∞–π–∫–∞–º–∏
- `eventRepository.ts` ‚Äî —Ä–∞–±–æ—Ç–∞ —Å —Å–æ–±—ã—Ç–∏—è–º–∏
- `analyticsRepository.ts` ‚Äî –∞–Ω–∞–ª–∏—Ç–∏–∫–∞ –¥–ª—è –∞–¥–º–∏–Ω–∫–∏

#### –†–∞–±–æ—Ç–∞ —Å —Ñ–∞–π–ª–∞–º–∏

**Object Storage (`services/objectStorage.ts`):**

**–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è:**

- –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ Yandex Object Storage —á–µ—Ä–µ–∑ AWS SDK
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ bucket –∏ credentials

**–ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ (`routes/photos.ts`):**

1. –ü–æ–ª—É—á–µ–Ω–∏–µ —Ñ–∞–π–ª–∞ —á–µ—Ä–µ–∑ Multer
2. –í–∞–ª–∏–¥–∞—Ü–∏—è (—Ä–∞–∑–º–µ—Ä, —Ç–∏–ø)
3. –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ Sharp (`utils/imageOptimizer.ts`):
   - –°–æ–∑–¥–∞–Ω–∏–µ 3 —Ä–∞–∑–º–µ—Ä–æ–≤: thumbnail, medium, full
   - –ö–æ–Ω–≤–µ—Ä—Ç–∞—Ü–∏—è –≤ WebP (–æ—Å–Ω–æ–≤–Ω–æ–π) –∏ JPEG (—Ñ–æ–ª–ª–±—ç–∫)
   - –ì–µ–Ω–µ—Ä–∞—Ü–∏—è blur placeholder
4. –ó–∞–≥—Ä—É–∑–∫–∞ –≤—Å–µ—Ö –≤–∞—Ä–∏–∞–Ω—Ç–æ–≤ –≤ Object Storage
5. –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ URLs –≤ –ë–î

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞ –≤ Storage:**

```
bucket/
‚îú‚îÄ‚îÄ photos/
‚îÇ   ‚îî‚îÄ‚îÄ {userId}/
‚îÇ       ‚îú‚îÄ‚îÄ thumbnail.webp
‚îÇ       ‚îú‚îÄ‚îÄ thumbnail.jpg
‚îÇ       ‚îú‚îÄ‚îÄ medium.webp
‚îÇ       ‚îú‚îÄ‚îÄ medium.jpg
‚îÇ       ‚îú‚îÄ‚îÄ full.webp
‚îÇ       ‚îî‚îÄ‚îÄ full.jpg
```

#### –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ

**Pino Logger (`logger.ts`):**

**–£—Ä–æ–≤–Ω–∏:**

- `error` ‚Äî –æ—à–∏–±–∫–∏
- `warn` ‚Äî –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è
- `info` ‚Äî –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è
- `debug` ‚Äî –æ—Ç–ª–∞–¥–æ—á–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

**–§–æ—Ä–º–∞—Ç—ã:**

- Development: `pino-pretty` (—á–∏—Ç–∞–µ–º—ã–π —Ñ–æ—Ä–º–∞—Ç)
- Production: JSON (—Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–π)

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏:**

- Yandex Cloud Logging (–≤ production)
- Console (–≤ development)

#### –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –∏ –∞–ª–µ—Ä—Ç—ã

**Error Monitoring (`monitoring.ts`):**

- Catcher (–¥–ª—è –†–æ—Å—Å–∏–∏)
- Yandex AppMetrica

**Alerts (`alerts.ts`):**

- –û—Ç–ø—Ä–∞–≤–∫–∞ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏—Ö –æ—à–∏–±–æ–∫ –≤ Telegram
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç Telegram Bot API

---

### 3. Telegram Bot

#### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (`bot/src/index.ts`)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

- Telegraf –±–æ—Ç
- Polling –≤ development
- Webhook –≤ production

**–ö–æ–º–∞–Ω–¥—ã:**

- `/start` ‚Äî –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
- `/help` ‚Äî —Å–ø–∏—Å–æ–∫ –∫–æ–º–∞–Ω–¥

**–£–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**

- –§—É–Ω–∫—Ü–∏—è `sendMatchNotification()` ‚Äî –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –æ –º–∞—Ç—á–∞—Ö
- –í—ã–∑—ã–≤–∞–µ—Ç—Å—è –∏–∑ backend —á–µ—Ä–µ–∑ webhook

**–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å Backend:**

- Backend –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç POST –∑–∞–ø—Ä–æ—Å –Ω–∞ `/notify/match`
- Bot –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º

---

### 4. Admin Panel

#### –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è (`admin/src/main.tsx`)

**–°—Ç—Ä—É–∫—Ç—É—Ä–∞:**

- React –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
- –ü—Ä–æ—Å—Ç–æ–π —Ä–æ—É—Ç–∏–Ω–≥ —á–µ—Ä–µ–∑ state
- –ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è —á–µ—Ä–µ–∑ localStorage

#### –°—Ç—Ä–∞–Ω–∏—Ü—ã (`admin/src/pages/`)

**Dashboard:**

- –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- –ì—Ä–∞—Ñ–∏–∫–∏ (Recharts)
- –≠–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö (PDF, Excel)

**UsersPage:**

- –°–ø–∏—Å–æ–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏

**EventsPage:**

- –°–ø–∏—Å–æ–∫ —Å–æ–±—ã—Ç–∏–π
- –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Å–æ–±—ã—Ç–∏—è–º–∏

**SettingsPage:**

- –ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã

#### API –∫–ª–∏–µ–Ω—Ç

**Axios —Å interceptors:**

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ —Ç–æ–∫–µ–Ω–∞ –≤ –∑–∞–≥–æ–ª–æ–≤–∫–∏
- –û–±—Ä–∞–±–æ—Ç–∫–∞ 401 (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π logout)
- –ë–∞–∑–æ–≤—ã–π URL –∏–∑ `config.js`

**–ê–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—è:**

- Login —á–µ—Ä–µ–∑ `/api/admin/auth/login`
- –¢–æ–∫–µ–Ω —Å–æ—Ö—Ä–∞–Ω—è–µ—Ç—Å—è –≤ localStorage
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–æ–∫–µ–Ω–∞ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

### 5. Shared Package

**–¢–∏–ø—ã (`shared/src/index.ts`):**

```typescript
export interface User { ... }
export interface Event { ... }
export interface Like { ... }
export interface Match { ... }
export interface Message { ... }
```

**–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ:**

- –ò–º–ø–æ—Ä—Ç–∏—Ä—É–µ—Ç—Å—è –≤–æ –≤—Å–µ—Ö –ø–∞–∫–µ—Ç–∞—Ö
- –û–±–µ—Å–ø–µ—á–∏–≤–∞–µ—Ç –µ–¥–∏–Ω–æ–æ–±—Ä–∞–∑–∏–µ —Ç–∏–ø–æ–≤
- –°–æ–±–∏—Ä–∞–µ—Ç—Å—è –ø–µ—Ä–≤—ã–º: `npm run build --workspace=shared`

---

## üîê –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π

**Telegram initData:**

1. Telegram –≥–µ–Ω–µ—Ä–∏—Ä—É–µ—Ç `initData` –ø—Ä–∏ –æ—Ç–∫—Ä—ã—Ç–∏–∏ WebApp
2. Frontend –ø–µ—Ä–µ–¥–∞–µ—Ç –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer <initData>`
3. Backend –≤–∞–ª–∏–¥–∏—Ä—É–µ—Ç –ø–æ–¥–ø–∏—Å—å —á–µ—Ä–µ–∑ Telegram Bot API
4. –ò–∑–≤–ª–µ–∫–∞–µ—Ç –¥–∞–Ω–Ω—ã–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (id, username, first_name)

**–í–∞–ª–∏–¥–∞—Ü–∏—è (`utils/telegramAuth.ts`):**

- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ–¥–ø–∏—Å–∏ —á–µ—Ä–µ–∑ HMAC-SHA-256
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—Ä–µ–º–µ–Ω–∏ (–Ω–µ —Å—Ç–∞—Ä—à–µ 24 —á–∞—Å–æ–≤)
- –ò–∑–≤–ª–µ—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

### –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è –∞–¥–º–∏–Ω–∞

**JWT —Ç–æ–∫–µ–Ω—ã:**

- Login —á–µ—Ä–µ–∑ `/api/admin/auth/login`
- –¢–æ–∫–µ–Ω –≤ –∑–∞–≥–æ–ª–æ–≤–∫–µ `Authorization: Bearer <token>`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∏ –∫–∞–∂–¥–æ–º –∑–∞–ø—Ä–æ—Å–µ

### –ó–∞—â–∏—Ç–∞ –æ—Ç –∞—Ç–∞–∫

**Rate Limiting:**

- –û–±—â–∏–µ –∑–∞–ø—Ä–æ—Å—ã: 100/15min
- –ê–¥–º–∏–Ω—Å–∫–∏–µ: 50/15min
- –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–∞–π–ª–æ–≤: 10/15min

**Sanitize:**

- –û—á–∏—Å—Ç–∫–∞ –≤—Å–µ—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –¥–∞–Ω–Ω—ã—Ö –æ—Ç XSS
- DOMPurify –¥–ª—è HTML –∫–æ–Ω—Ç–µ–Ω—Ç–∞

**Helmet:**

- Security headers
- CSP (Content Security Policy)
- –ù–∞—Å—Ç—Ä–æ–µ–Ω –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Telegram WebApp

**CORS:**

- –¢–æ–ª—å–∫–æ —Ä–∞–∑—Ä–µ—à–µ–Ω–Ω—ã–µ origins
- Credentials: true
- Preflight –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ (24 —á–∞—Å–∞)

---

## üìä –ü–æ—Ç–æ–∫–∏ –¥–∞–Ω–Ω—ã—Ö

### –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç—á–∞

```
1. User –ª–∞–π–∫–∞–µ—Ç –¥—Ä—É–≥–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ Frontend
2. Frontend ‚Üí POST /api/v1/matches { userId1, userId2, eventId }
3. Backend –ø—Ä–æ–≤–µ—Ä—è–µ—Ç –≤–∑–∞–∏–º–Ω—ã–π –ª–∞–π–∫ –≤ –ë–î
4. –ï—Å–ª–∏ –≤–∑–∞–∏–º–Ω—ã–π:
   - –°–æ–∑–¥–∞–µ—Ç –∑–∞–ø–∏—Å—å –≤ —Ç–∞–±–ª–∏—Ü–µ matches
   - –û—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–µ –≤ Bot —á–µ—Ä–µ–∑ webhook
   - Bot –æ—Ç–ø—Ä–∞–≤–ª—è–µ—Ç —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –æ–±–æ–∏–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º
5. Backend ‚Üí Frontend: { success: true, data: match }
6. Frontend –æ–±–Ω–æ–≤–ª—è–µ—Ç —Å–ø–∏—Å–æ–∫ –º–∞—Ç—á–µ–π
```

### –ó–∞–≥—Ä—É–∑–∫–∞ —Ñ–æ—Ç–æ

```
1. User –≤—ã–±–∏—Ä–∞–µ—Ç —Ñ–æ—Ç–æ –≤ Frontend
2. Frontend ‚Üí POST /api/v1/photos (multipart/form-data)
3. Backend:
   - –í–∞–ª–∏–¥–∏—Ä—É–µ—Ç —Ñ–∞–π–ª (—Ä–∞–∑–º–µ—Ä, —Ç–∏–ø)
   - –û–ø—Ç–∏–º–∏–∑–∏—Ä—É–µ—Ç —á–µ—Ä–µ–∑ Sharp:
     * thumbnail (150x150)
     * medium (800x800)
     * full (–æ—Ä–∏–≥–∏–Ω–∞–ª)
     * WebP + JPEG –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–∞–∑–º–µ—Ä–∞
   - –ó–∞–≥—Ä—É–∂–∞–µ—Ç –≤—Å–µ –≤–∞—Ä–∏–∞–Ω—Ç—ã –≤ Object Storage
   - –°–æ—Ö—Ä–∞–Ω—è–µ—Ç URLs –≤ –ë–î
4. Backend ‚Üí Frontend: { success: true, data: { urls, blur } }
5. Frontend –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç –æ–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –ª–µ–Ω—Ç—ã —Å–æ–±—ã—Ç–∏–π

```
1. User –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç –≥–ª–∞–≤–Ω—É—é —Å—Ç—Ä–∞–Ω–∏—Ü—É
2. Frontend ‚Üí GET /api/v1/feed
3. Backend:
   - –ü–æ–ª—É—á–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è –∏–∑ –ë–î
   - –§–∏–ª—å—Ç—Ä—É–µ—Ç –ø–æ –∫–∞—Ç–µ–≥–æ—Ä–∏—è–º/–¥–∞—Ç–µ
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–ø–∏—Å–æ–∫
4. Backend ‚Üí Frontend: { success: true, data: events[] }
5. Frontend –∫–µ—à–∏—Ä—É–µ—Ç —á–µ—Ä–µ–∑ React Query (5 –º–∏–Ω—É—Ç)
6. –û—Ç–æ–±—Ä–∞–∂–∞–µ—Ç —Å–æ–±—ã—Ç–∏—è —Å lazy loading –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π
```

### –ê–¥–º–∏–Ω—Å–∫–∞—è –∞–Ω–∞–ª–∏—Ç–∏–∫–∞

```
1. Admin –æ—Ç–∫—Ä—ã–≤–∞–µ—Ç Dashboard
2. Admin Panel ‚Üí GET /api/admin/analytics/overview
3. Backend:
   - –ó–∞–ø—Ä–æ—Å—ã –∫ –ë–î —á–µ—Ä–µ–∑ analyticsRepository
   - –ê–≥—Ä–µ–≥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö (COUNT, SUM, GROUP BY)
   - –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
4. Backend ‚Üí Admin Panel: { success: true, data: analytics }
5. Admin Panel –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç –≥—Ä–∞—Ñ–∏–∫–∏ (Recharts)
```

---

## üöÄ –î–µ–ø–ª–æ–π

### Frontend

**–°–±–æ—Ä–∫–∞:**

```bash
npm run build:frontend
```

**–î–µ–ø–ª–æ–π –≤ Object Storage:**

```bash
npm run deploy:frontend
```

**–ü—Ä–æ—Ü–µ—Å—Å:**

1. –°–±–æ—Ä–∫–∞ —á–µ—Ä–µ–∑ Vite
2. –ó–∞–≥—Ä—É–∑–∫–∞ –≤ Yandex Object Storage —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ CDN –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏
4. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏

**GitHub Actions:**

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ push –≤ main
- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç secrets –∏–∑ GitHub Environments

### Backend

**–°–±–æ—Ä–∫–∞:**

```bash
npm run build:backend
```

**–î–µ–ø–ª–æ–π –≤ Cloud Container:**

1. –°–±–æ—Ä–∫–∞ Docker –æ–±—Ä–∞–∑–∞
2. Push –≤ Container Registry
3. –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ Container –≤ Yandex Cloud
4. Health check

**–ò–ª–∏ Cloud Functions:**

1. –°–æ–∑–¥–∞–Ω–∏–µ function.zip
2. –ó–∞–≥—Ä—É–∑–∫–∞ –≤ Cloud Functions
3. –ù–∞—Å—Ç—Ä–æ–π–∫–∞ API Gateway

### Admin

**–°–±–æ—Ä–∫–∞:**

```bash
npm run build:admin
```

**–î–µ–ø–ª–æ–π:**

- –ê–Ω–∞–ª–æ–≥–∏—á–Ω–æ Frontend
- –í –æ—Ç–¥–µ–ª—å–Ω—ã–π bucket –∏–ª–∏ –ø–æ–¥–ø–∞–ø–∫—É

### Bot

**–î–µ–ø–ª–æ–π:**

- Cloud Functions –∏–ª–∏ Container
- –ù–∞—Å—Ç—Ä–æ–π–∫–∞ webhook –≤ Telegram

---

## üîß –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

### –õ–æ–∫–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫

**–í—Å–µ —Å–µ—Ä–≤–∏—Å—ã:**

```bash
NODE_ENV=development npm run dev:all
```

**–û—Ç–¥–µ–ª—å–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:**

```bash
npm run dev:frontend   # http://localhost:3000
npm run dev:backend   # http://localhost:4000
npm run dev:admin     # http://localhost:5174
npm run dev:bot       # Polling mode
```

### –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è

**–ú–∏–Ω–∏–º–∞–ª—å–Ω—ã–π –Ω–∞–±–æ—Ä (.env):**

```bash
NODE_ENV=development
TELEGRAM_BOT_TOKEN_DEV=your-token
YDB_ENDPOINT_DEV=grpcs://ydb.serverless.yandexcloud.net:2135
YDB_DATABASE_DEV=/ru-central1/b1g.../etn...
YC_SERVICE_ACCOUNT_KEY_FILE=./yc-service-account-key.json
```

**–ü–æ–ª–Ω—ã–π —Å–ø–∏—Å–æ–∫:** —Å–º. `docs/ENVIRONMENTS.md`

### –ú–∏–≥—Ä–∞—Ü–∏–∏ –ë–î

**–ó–∞–ø—É—Å–∫:**

```bash
npm run migrate
```

**–°—Ç–∞—Ç—É—Å:**

```bash
npm run migrate:status
```

**–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫:**

- –ü—Ä–∏ —Å—Ç–∞—Ä—Ç–µ backend —Å–µ—Ä–≤–µ—Ä–∞
- –ù–µ –±–ª–æ–∫–∏—Ä—É–µ—Ç –∑–∞–ø—É—Å–∫ –ø—Ä–∏ –æ—à–∏–±–∫–µ

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

**API:**

```bash
curl http://localhost:4000/health
```

**Storage:**

```bash
npm run test:storage
```

**Figma:**

```bash
npm run test:figma
```

---

## üìà –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

### –õ–æ–≥–∏

**Yandex Cloud Logging:**

- –í—Å–µ –ª–æ–≥–∏ backend –≤ —Å—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–º JSON
- –ü–æ–∏—Å–∫ –∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è —á–µ—Ä–µ–∑ –∫–æ–Ω—Å–æ–ª—å
- Retention: 7 –¥–Ω–µ–π (–Ω–∞—Å—Ç—Ä–∞–∏–≤–∞–µ—Ç—Å—è)

**–¢–∏–ø—ã –ª–æ–≥–æ–≤:**

- `app_startup` ‚Äî –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- `ydb_connection` ‚Äî –ø–æ–¥–∫–ª—é—á–µ–Ω–∏–µ –∫ –ë–î
- `http_request` ‚Äî HTTP –∑–∞–ø—Ä–æ—Å—ã
- `match_created` ‚Äî —Å–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç—á–µ–π
- `error` ‚Äî –æ—à–∏–±–∫–∏

### Error Tracking

**Catcher / Yandex AppMetrica:**

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π —Å–±–æ—Ä –æ—à–∏–±–æ–∫
- –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ø–æ —Ç–∏–ø–∞–º
- Stack traces
- User context

### –ê–ª–µ—Ä—Ç—ã

**Telegram —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è:**

- –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ –æ—à–∏–±–∫–∏
- –ü—Ä–æ–±–ª–µ–º—ã —Å –ë–î
- –ü—Ä–æ–±–ª–µ–º—ã —Å Object Storage

---

## üóÑÔ∏è –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö (YDB)

### –°—Ö–µ–º–∞

**–¢–∞–±–ª–∏—Ü—ã:**

1. **users**
   - id (String, PK)
   - telegramId (Uint64, indexed)
   - username, firstName, lastName
   - photoUrl, bio, age
   - createdAt, updatedAt

2. **events**
   - id (String, PK)
   - title, description, category
   - imageUrl, location, date
   - createdAt, updatedAt

3. **matches**
   - id (String, PK)
   - userId1, userId2 (String, indexed)
   - eventId (String, nullable, indexed)
   - createdAt

4. **likes**
   - id (String, PK)
   - fromUserId, toUserId (String, indexed)
   - eventId (String, nullable, indexed)
   - createdAt

5. **messages**
   - id (String, PK)
   - matchId (String, indexed)
   - senderId (String, indexed)
   - content
   - createdAt

### –ó–∞–ø—Ä–æ—Å—ã

**YDB Query Language (YQL):**

- SQL-–ø–æ–¥–æ–±–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å
- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –ø–∞—Ä–∞–º–µ—Ç—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –∑–∞–ø—Ä–æ—Å–æ–≤
- –¢—Ä–∞–Ω–∑–∞–∫—Ü–∏–∏

**–ü—Ä–∏–º–µ—Ä:**

```typescript
const query = `
  SELECT * FROM users
  WHERE telegramId = $telegramId
`;
const result = await ydbClient.executeQuery(query, { telegramId: 123 });
```

---

## üì¶ Object Storage

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞

**Bucket:**

- `photos/{userId}/` ‚Äî —Ñ–æ—Ç–æ–≥—Ä–∞—Ñ–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- `events/{eventId}/` ‚Äî –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è —Å–æ–±—ã—Ç–∏–π
- `static/` ‚Äî —Å—Ç–∞—Ç–∏—á–µ—Å–∫–∏–µ —Ñ–∞–π–ª—ã

### –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**Sharp:**

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–æ–≤
- WebP (–æ—Å–Ω–æ–≤–Ω–æ–π) + JPEG (—Ñ–æ–ª–ª–±—ç–∫)
- Blur placeholder –¥–ª—è –±—ã—Å—Ç—Ä–æ–π –∑–∞–≥—Ä—É–∑–∫–∏
- –°–∂–∞—Ç–∏–µ —Å —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –∫–∞—á–µ—Å—Ç–≤–∞

**–†–∞–∑–º–µ—Ä—ã:**

- thumbnail: 150x150
- medium: 800x800
- full: –æ—Ä–∏–≥–∏–Ω–∞–ª (–º–∞–∫—Å 2000x2000)

---

## üé® Design System

### –ö–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

**381 –∫–æ–º–ø–æ–Ω–µ–Ω—Ç –∏–∑ Figma:**

- –ò–º–ø–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã —á–µ—Ä–µ–∑ —Å–∫—Ä–∏–ø—Ç—ã
- –°—Ç—Ä—É–∫—Ç—É—Ä–∞: `ComponentName/ComponentName.tsx + ComponentName.module.css`
- TypeScript —Ç–∏–ø—ã –¥–ª—è –ø—Ä–æ–ø—Å–æ–≤

### –¢–æ–∫–µ–Ω—ã

**–§–∞–π–ª—ã (`frontend/src/design-system/tokens/`):**

- `colors.ts` ‚Äî —Ü–≤–µ—Ç–æ–≤–∞—è –ø–∞–ª–∏—Ç—Ä–∞
- `typography.ts` ‚Äî —à—Ä–∏—Ñ—Ç—ã –∏ —Ä–∞–∑–º–µ—Ä—ã
- `spacing.ts` ‚Äî –æ—Ç—Å—Ç—É–ø—ã
- `radius.ts` ‚Äî —Å–∫—Ä—É–≥–ª–µ–Ω–∏—è
- `shadows.ts` ‚Äî —Ç–µ–Ω–∏
- `breakpoints.ts` ‚Äî —Ç–æ—á–∫–∏ –æ—Å—Ç–∞–Ω–æ–≤–∞

**CSS Variables:**

- –ü–æ–¥–¥–µ—Ä–∂–∫–∞ —Ç–µ–º–Ω–æ–π/—Å–≤–µ—Ç–ª–æ–π —Ç–µ–º—ã
- –î–∏–Ω–∞–º–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ

---

## üîÑ CI/CD

### GitHub Actions

**Workflows:**

- `.github/workflows/deploy-frontend.yml`
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –¥–µ–ø–ª–æ–π –ø—Ä–∏ push –≤ main

**Secrets:**

- `YC_SERVICE_ACCOUNT_KEY` ‚Äî –∫–ª—é—á —Å–µ—Ä–≤–∏—Å–Ω–æ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞
- `FRONTEND_STORAGE_BUCKET_DEV/PROD` ‚Äî bucket –¥–ª—è —Å—Ç–∞—Ç–∏–∫–∏
- `FRONTEND_STORAGE_ACCESS_KEY_DEV/PROD` ‚Äî –∫–ª—é—á–∏ –¥–æ—Å—Ç—É–ø–∞

---

## üìù –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

### –†–∞–∑—Ä–∞–±–æ—Ç–∫–∞

1. **–í—Å–µ–≥–¥–∞ —Å–æ–±–∏—Ä–∞—Ç—å shared –ø–µ—Ä–≤—ã–º:**

   ```bash
   npm run build --workspace=shared
   ```

2. **–ü—Ä–æ–≤–µ—Ä–∫–∞ —Ç–∏–ø–æ–≤:**
   - TypeScript —Å—Ç—Ä–æ–≥–∏–π —Ä–µ–∂–∏–º
   - –û–±—â–∏–µ —Ç–∏–ø—ã –∏–∑ shared –ø–∞–∫–µ—Ç–∞

3. **–õ–∏–Ω—Ç–∏–Ω–≥:**
   ```bash
   npm run lint
   ```

### Production

1. **–ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫—Ä—É–∂–µ–Ω–∏—è:**
   - –í—Å–µ–≥–¥–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å PROD –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ
   - –ù–∏–∫–æ–≥–¥–∞ –Ω–µ –∫–æ–º–º–∏—Ç–∏—Ç—å secrets

2. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:**
   - –ü—Ä–æ–≤–µ—Ä—è—Ç—å –ª–æ–≥–∏ —Ä–µ–≥—É–ª—è—Ä–Ω–æ
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –∞–ª–µ—Ä—Ç—ã

3. **–ë—ç–∫–∞–ø—ã:**
   - YDB –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–µ –±—ç–∫–∞–ø—ã
   - Object Storage –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ

---

## üêõ Troubleshooting

### Backend –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è –∫ YDB

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `YDB_ENDPOINT_DEV` –∏ `YDB_DATABASE_DEV`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `YC_SERVICE_ACCOUNT_KEY_FILE` –∏–ª–∏ `YDB_TOKEN_DEV`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å —Å–µ—Ç–µ–≤—É—é –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å endpoint
4. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ª–æ–≥–∏: `npm run dev:backend`

### Frontend –Ω–µ –ø–æ–¥–∫–ª—é—á–∞–µ—Ç—Å—è –∫ API

**–ü—Ä–æ–±–ª–µ–º–∞:** CORS –æ—à–∏–±–∫–∏

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `VITE_API_URL` –≤ frontend
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `ALLOWED_ORIGINS` –≤ backend
3. –í development —Ä–∞–∑—Ä–µ—à–µ–Ω—ã –≤—Å–µ origins

### –§–æ—Ç–æ –Ω–µ –∑–∞–≥—Ä—É–∂–∞—é—Ç—Å—è

**–ü—Ä–æ–±–ª–µ–º–∞:** –û—à–∏–±–∫–∞ Object Storage

**–†–µ—à–µ–Ω–∏–µ:**

1. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `YANDEX_STORAGE_BUCKET`
2. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å `YANDEX_STORAGE_ACCESS_KEY` –∏ `SECRET_KEY`
3. –ü—Ä–æ–≤–µ—Ä–∏—Ç—å –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ bucket

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è

- `README.md` ‚Äî –≥–ª–∞–≤–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `docs/ARCHITECTURE.md` ‚Äî –ø–æ–¥—Ä–æ–±–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞
- `docs/API.md` ‚Äî API –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
- `docs/SETUP_GUIDE.md` ‚Äî —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ
- `PROJECT_STATUS.md` ‚Äî —Ç–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å –ø—Ä–æ–µ–∫—Ç–∞

---

## üö® –í—ã—è–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –∏ —Ä–∏—Å–∫–∏

> **–í–∞–∂–Ω–æ:** –≠—Ç–æ—Ç —Ä–∞–∑–¥–µ–ª —Å–æ–¥–µ—Ä–∂–∏—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –∞—É–¥–∏—Ç–∞ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏ –∏ –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—ã. –í—Å–µ –ø—Ä–æ–±–ª–µ–º—ã –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω—ã –ø–æ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—É.

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### 1. Telegram Auth - –ü—Ä–æ–≤–µ—Ä–∫–∞ auth_date

**–°—Ç–∞—Ç—É—Å:** ‚úÖ **–ß–∞—Å—Ç–∏—á–Ω–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ** (–ø—Ä–æ–≤–µ—Ä–∫–∞ –µ—Å—Ç—å, –Ω–æ –Ω—É–∂–Ω–æ —É–ª—É—á—à–∏—Ç—å)

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –§—É–Ω–∫—Ü–∏—è `isInitDataValid()` —Å—É—â–µ—Å—Ç–≤—É–µ—Ç –∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç TTL (24 —á–∞—Å–∞)
- –ü—Ä–æ–≤–µ—Ä–∫–∞ –≤—ã–∑—ã–≤–∞–µ—Ç—Å—è –≤ `validateTelegramInitData()`
- **–ù–û:** –ù–µ—Ç rate limiting –Ω–∞ —É—Ä–æ–≤–Ω–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—Ç–æ–ª—å–∫–æ –æ–±—â–∏–π)

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```typescript
// backend/src/utils/telegramAuth.ts
export function isInitDataValid(initData: string): boolean {
  const authDate = parseInt(params.auth_date, 10);
  const now = Math.floor(Date.now() / 1000);
  const age = now - authDate;
  const maxAge = 24 * 60 * 60; // 24 —á–∞—Å–∞
  return age >= 0 && age < maxAge;
}
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ TTL —É–∂–µ —Ä–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞
- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å rate limiting –Ω–∞ —É—Ä–æ–≤–Ω–µ `telegramId` (–Ω–µ —Ç–æ–ª—å–∫–æ IP)
- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–ø—ã—Ç–æ–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∏—Å—Ç–µ–∫—à–∏—Ö —Ç–æ–∫–µ–Ω–æ–≤

#### 2. Admin Auth - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ JWT –∏ refresh tokens

**–°—Ç–∞—Ç—É—Å:** ‚ùå **–¢—Ä–µ–±—É–µ—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è**

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ø—Ä–æ—Å—Ç–æ–π —Ç–æ–∫–µ–Ω –∏–∑ env –ø–µ—Ä–µ–º–µ–Ω–Ω–æ–π (`ADMIN_TOKEN`)
- –ù–µ—Ç JWT —Ç–æ–∫–µ–Ω–æ–≤
- –ù–µ—Ç refresh token –º–µ—Ö–∞–Ω–∏–∑–º–∞
- –ù–µ—Ç —Å–ø–æ—Å–æ–±–∞ –∏–Ω–≤–∞–ª–∏–¥–∏—Ä–æ–≤–∞—Ç—å —Å–µ—Å—Å–∏—é –ø—Ä–∏ –∫—Ä–∞–∂–µ —Ç–æ–∫–µ–Ω–∞
- –ù–µ—Ç rotation —Ç–æ–∫–µ–Ω–æ–≤
- –ù–µ —É–∫–∞–∑–∞–Ω–æ, –≥–¥–µ —Ö—Ä–∞–Ω–∏—Ç—Å—è —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤ (–≤ –∫–æ–¥–µ –∏–ª–∏ –ë–î?)

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```typescript
// backend/src/middleware/adminAuth.ts
const ADMIN_TOKEN = process.env.ADMIN_TOKEN || 'admin-secret-token-change-in-production';
if (token !== ADMIN_TOKEN) {
  return res.status(403).json({ ... });
}
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- üî¥ –í–Ω–µ–¥—Ä–∏—Ç—å JWT —Ç–æ–∫–µ–Ω—ã —Å expiration
- üî¥ –î–æ–±–∞–≤–∏—Ç—å refresh token –º–µ—Ö–∞–Ω–∏–∑–º
- üî¥ –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `admin_sessions` –≤ –ë–î –¥–ª—è –æ—Ç—Å–ª–µ–∂–∏–≤–∞–Ω–∏—è –∞–∫—Ç–∏–≤–Ω—ã—Ö —Å–µ—Å—Å–∏–π
- üî¥ –î–æ–±–∞–≤–∏—Ç—å endpoint –¥–ª—è logout (–∏–Ω–≤–∞–ª–∏–¥–∞—Ü–∏—è —Ç–æ–∫–µ–Ω–∞)
- üî¥ –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å rotation —Ç–æ–∫–µ–Ω–æ–≤
- üî¥ –•—Ä–∞–Ω–∏—Ç—å —Å–ø–∏—Å–æ–∫ –∞–¥–º–∏–Ω–æ–≤ –≤ –ë–î (—Ç–∞–±–ª–∏—Ü–∞ `admins`)

---

### ‚ö†Ô∏è –ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

#### 3. –ü—Å–µ–≤–¥–æ-–º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ê—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–Ω–æ–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ**

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –≠—Ç–æ –Ω–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å–Ω–∞—è –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä–∞, –∞ –º–æ–¥—É–ª—å–Ω—ã–π –º–æ–Ω–æ–ª–∏—Ç
- –í—Å–µ —Å–µ—Ä–≤–∏—Å—ã –≤ –æ–¥–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏ —Å shared –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç—è–º–∏
- Backend –∏ Bot –Ω–µ –º–æ–≥—É—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å—Å—è –Ω–µ–∑–∞–≤–∏—Å–∏–º–æ
- –ù–∞—Ä—É—à–µ–Ω–∏–µ –ø—Ä–∏–Ω—Ü–∏–ø–∞ "Database per Service" ‚Äî –≤—Å–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç –æ–¥–∏–Ω YDB

**–¢–µ–∫—É—â–∞—è —Å—Ç—Ä—É–∫—Ç—É—Ä–∞:**

```
lug/
‚îú‚îÄ‚îÄ frontend/  (–º–æ–∂–µ—Ç –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞—Ç—å—Å—è)
‚îú‚îÄ‚îÄ backend/   (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç YDB)
‚îú‚îÄ‚îÄ bot/       (–∑–∞–≤–∏—Å–∏—Ç –æ—Ç backend)
‚îî‚îÄ‚îÄ shared/    (–æ–±—â–∏–µ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏)
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- ‚ö†Ô∏è –ü—Ä–∏–∑–Ω–∞—Ç—å —Ç–µ–∫—É—â—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∫–∞–∫ "–º–æ–¥—É–ª—å–Ω—ã–π –º–æ–Ω–æ–ª–∏—Ç" (—ç—Ç–æ –Ω–æ—Ä–º–∞–ª—å–Ω–æ –¥–ª—è MVP)
- ‚ö†Ô∏è –ü—Ä–∏ —Ä–æ—Å—Ç–µ –Ω–∞–≥—Ä—É–∑–∫–∏ —Ä–∞—Å—Å–º–æ—Ç—Ä–µ—Ç—å —Ä–∞–∑–¥–µ–ª–µ–Ω–∏–µ –Ω–∞ –Ω–∞—Å—Ç–æ—è—â–∏–µ –º–∏–∫—Ä–æ—Å–µ—Ä–≤–∏—Å—ã
- ‚ö†Ô∏è –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å —Ç–µ–∫—É—â—É—é –∞—Ä—Ö–∏—Ç–µ–∫—Ç—É—Ä—É –∫–∞–∫ –µ—Å—Ç—å

#### 4. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ –æ—á–µ—Ä–µ–¥–µ–π –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–°—Ç–∞—Ç—É—Å:** üî¥ **–ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è production**

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –°–æ–∑–¥–∞–Ω–∏–µ –º–∞—Ç—á–∞ ‚Üí –æ—Ç–ø—Ä–∞–≤–∫–∞ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π –ø—Ä–æ–∏—Å—Ö–æ–¥–∏—Ç —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ —á–µ—Ä–µ–∑ `fetch()`
- –ï—Å–ª–∏ Bot –Ω–µ–¥–æ—Å—Ç—É–ø–µ–Ω, –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∏—Ç –æ—à–∏–±–∫—É –ø—Ä–∏ –ª–∞–π–∫–µ
- –ù–µ—Ç retry –º–µ—Ö–∞–Ω–∏–∑–º–∞ –¥–ª—è failed —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π
- –ù–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏ –¥–æ—Å—Ç–∞–≤–∫–∏ —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```typescript
// backend/src/routes/matches.ts
notifyBotAboutMatch({ ... }).catch((error) => {
  logger.error({ error, type: 'match_notification_error' });
});
// –ù–µ –∂–¥–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç, –Ω–æ –Ω–µ—Ç –≥–∞—Ä–∞–Ω—Ç–∏–∏ –¥–æ—Å—Ç–∞–≤–∫–∏
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- üî¥ –í–Ω–µ–¥—Ä–∏—Ç—å Yandex Message Queue (YMQ) –º–µ–∂–¥—É backend –∏ bot
- üî¥ –î–æ–±–∞–≤–∏—Ç—å retry –º–µ—Ö–∞–Ω–∏–∑–º —Å exponential backoff
- üî¥ –°–æ—Ö—Ä–∞–Ω—è—Ç—å failed —É–≤–µ–¥–æ–º–ª–µ–Ω–∏—è –≤ –ë–î –¥–ª—è –ø–æ–≤—Ç–æ—Ä–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏
- üî¥ –î–æ–±–∞–≤–∏—Ç—å dead letter queue –¥–ª—è –Ω–µ–æ–±—Ä–∞–±–æ—Ç–∞–Ω–Ω—ã—Ö —Å–æ–æ–±—â–µ–Ω–∏–π

---

### üìä –ü—Ä–æ–±–ª–µ–º—ã —Å –¥–∞–Ω–Ω—ã–º–∏

#### 5. React Query –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç —É–ª—É—á—à–µ–Ω–∏—è**

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ö–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ –Ω–∞ 5 –º–∏–Ω—É—Ç –¥–ª—è –ª–µ–Ω—Ç—ã —Å–æ–±—ã—Ç–∏–π
- –ü—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ —Å–æ–±—ã—Ç–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–µ —É–≤–∏–¥–∏—Ç –µ–≥–æ —Å—Ä–∞–∑—É
- –ù–µ—Ç —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏ invalidation –ø–æ—Å–ª–µ –º—É—Ç–∞—Ü–∏–π
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç optimistic updates –¥–ª—è –ª–∞–π–∫–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å `queryClient.invalidateQueries()` –ø–æ—Å–ª–µ –º—É—Ç–∞—Ü–∏–π
- ‚ö†Ô∏è –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å optimistic updates –¥–ª—è –ª–∞–π–∫–æ–≤
- ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å `refetchOnWindowFocus: false` –¥–ª—è –º–æ–±–∏–ª—å–Ω—ã—Ö
- ‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å staleTime –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ –¥–∞–Ω–Ω—ã—Ö

#### 6. YDB - –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Å–æ—Å—Ç–∞–≤–Ω—ã—Ö –∏–Ω–¥–µ–∫—Å–æ–≤

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**

**–ü—Ä–æ–±–ª–µ–º–∞:**

- `matches` —Ç–∞–±–ª–∏—Ü–∞: –Ω–µ—Ç —Å–æ—Å—Ç–∞–≤–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ –Ω–∞ `(userId1, userId2)`
- –ó–∞–ø—Ä–æ—Å—ã "–≤—Å–µ –º–∞—Ç—á–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è" –±—É–¥—É—Ç –º–µ–¥–ª–µ–Ω–Ω—ã–º–∏ –ø—Ä–∏ —Ä–æ—Å—Ç–µ –¥–∞–Ω–Ω—ã—Ö
- `likes` —Ç–∞–±–ª–∏—Ü–∞: –µ—Å—Ç—å —Å–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å `idx_from_to`, –Ω–æ –º–æ–∂–µ—Ç —Å—Ç–∞—Ç—å –≥–æ—Ä—è—á–µ–π —Ç–æ—á–∫–æ–π

**–¢–µ–∫—É—â–∞—è —Å—Ö–µ–º–∞:**

```typescript
// matchesTable
indexes: [
  { name: 'idx_user1', columns: ['userId1'] },
  { name: 'idx_user2', columns: ['userId2'] },
  // ‚ùå –ù–µ—Ç —Å–æ—Å—Ç–∞–≤–Ω–æ–≥–æ –∏–Ω–¥–µ–∫—Å–∞ (userId1, userId2)
];
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–∞–≤–Ω–æ–π –∏–Ω–¥–µ–∫—Å `idx_user1_user2` –Ω–∞ `(userId1, userId2)`
- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å `idx_user1_created` –¥–ª—è —Å–æ—Ä—Ç–∏—Ä–æ–≤–∫–∏ –ø–æ –¥–∞—Ç–µ
- ‚ö†Ô∏è –ú–æ–Ω–∏—Ç–æ—Ä–∏—Ç—å –ø—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å –∑–∞–ø—Ä–æ—Å–æ–≤ –ø—Ä–∏ —Ä–æ—Å—Ç–µ –¥–∞–Ω–Ω—ã—Ö

#### 7. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ pagination

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ú–∞—Å—à—Ç–∞–±–∏—Ä—É–µ–º–æ—Å—Ç—å**

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –í –Ω–µ–∫–æ—Ç–æ—Ä—ã—Ö endpoints –Ω–µ—Ç —è–≤–Ω–æ–π pagination
- –ú–æ–∂–µ—Ç –ø—Ä–∏–≤–µ—Å—Ç–∏ –∫ –ø—Ä–æ–±–ª–µ–º–∞–º –ø—Ä–∏ –±–æ–ª—å—à–æ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–µ –¥–∞–Ω–Ω—ã—Ö

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å pagination –≤–æ –≤—Å–µ —Å–ø–∏—Å–∫–æ–≤—ã–µ endpoints
- ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å cursor-based pagination –¥–ª—è –±–æ–ª—å—à–∏—Ö –Ω–∞–±–æ—Ä–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- ‚ö†Ô∏è –û–≥—Ä–∞–Ω–∏—á–∏—Ç—å –º–∞–∫—Å–∏–º–∞–ª—å–Ω—ã–π `limit` (–Ω–∞–ø—Ä–∏–º–µ—Ä, 100)

---

### üîß –û–ø–µ—Ä–∞—Ü–∏–æ–Ω–Ω—ã–µ —Ä–∏—Å–∫–∏

#### 8. –ú–∏–≥—Ä–∞—Ü–∏–∏ –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–†–∏—Å–∫ –ø—Ä–∏ –º–∞—Å—à—Ç–∞–±–∏—Ä–æ–≤–∞–Ω–∏–∏**

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π –∑–∞–ø—É—Å–∫ –º–∏–≥—Ä–∞—Ü–∏–π –ø—Ä–∏ —Å—Ç–∞—Ä—Ç–µ backend
- –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤—Å–µ –∏–Ω—Å—Ç–∞–Ω—Å—ã —É–ø–∞–¥—É—Ç –æ–¥–Ω–æ–≤—Ä–µ–º–µ–Ω–Ω–æ
- –ü—Ä–∏ horizontal scaling –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏–Ω—Å—Ç–∞–Ω—Å–æ–≤ –º–æ–≥—É—Ç –∑–∞–ø—É—Å–∫–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ
- –ù–µ—Ç rollback —Å—Ç—Ä–∞—Ç–µ–≥–∏–∏

**–¢–µ–∫—É—â–∞—è —Ä–µ–∞–ª–∏–∑–∞—Ü–∏—è:**

```typescript
// backend/src/index.ts
initYDB().then(async () => {
  await runMigrations();
});
```

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- ‚ö†Ô∏è –í—ã–Ω–µ—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å (job/script)
- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –¥–ª—è –ø—Ä–µ–¥–æ—Ç–≤—Ä–∞—â–µ–Ω–∏—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞
- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É –≤–µ—Ä—Å–∏–∏ –ë–î –ø–µ—Ä–µ–¥ –∑–∞–ø—É—Å–∫–æ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
- ‚ö†Ô∏è –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å rollback –º–µ—Ö–∞–Ω–∏–∑–º

#### 9. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ —Ç–µ—Å—Ç–æ–≤

**–°—Ç–∞—Ç—É—Å:** üî¥ **–ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è production**

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ù–µ—Ç unit —Ç–µ—Å—Ç–æ–≤
- –ù–µ—Ç integration —Ç–µ—Å—Ç–æ–≤
- –ù–µ—Ç e2e —Ç–µ—Å—Ç–æ–≤
- –ö—Ä–∏—Ç–∏—á–Ω–æ –¥–ª—è dating app —Å –º–∞—Ç—á–∏–Ω–≥–æ–º

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- üî¥ –î–æ–±–∞–≤–∏—Ç—å unit —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω–æ–π –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ (–º–∞—Ç—á–∏–Ω–≥, –≤–∞–ª–∏–¥–∞—Ü–∏—è)
- üî¥ –î–æ–±–∞–≤–∏—Ç—å integration —Ç–µ—Å—Ç—ã –¥–ª—è API endpoints
- üî¥ –î–æ–±–∞–≤–∏—Ç—å e2e —Ç–µ—Å—Ç—ã –¥–ª—è –æ—Å–Ω–æ–≤–Ω—ã—Ö —Å—Ü–µ–Ω–∞—Ä–∏–µ–≤ (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è, –ª–∞–π–∫, –º–∞—Ç—á)
- üî¥ –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –∑–∞–ø—É—Å–∫–∞ —Ç–µ—Å—Ç–æ–≤

---

### üíæ Object Storage

#### 10. –°–∏–Ω—Ö—Ä–æ–Ω–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ü—Ä–æ–∏–∑–≤–æ–¥–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å**

**–ü—Ä–æ–±–ª–µ–º–∞:**

- Sharp –æ–±—Ä–∞–±–æ—Ç–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø–æ—Ç–æ–∫
- –ü—Ä–∏ –º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω–æ–π –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–æ—Ç–æ –º–æ–∂–µ—Ç —Å–æ–∑–¥–∞—Ç—å queue
- –ù–µ—Ç CDN caching strategy –¥–ª—è –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- ‚ö†Ô∏è –í—ã–Ω–µ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π Cloud Function
- ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å async queue –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
- ‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CDN —Å –∫–µ—à–∏—Ä–æ–≤–∞–Ω–∏–µ–º –¥–ª—è Object Storage
- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å cache headers (max-age, etag)

#### 11. –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ cleanup –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ù–∞–∫–æ–ø–ª–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö**

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ü—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è orphaned —Ñ–∞–π–ª—ã –≤ Storage –±—É–¥—É—Ç –Ω–∞–∫–∞–ø–ª–∏–≤–∞—Ç—å—Å—è
- –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ –æ—á–∏—Å—Ç–∫–∏ –Ω–µ–∏—Å–ø–æ–ª—å–∑—É–µ–º—ã—Ö —Ñ–∞–π–ª–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å cleanup job –¥–ª—è —É–¥–∞–ª–µ–Ω–∏—è —Ñ–∞–π–ª–æ–≤ –ø—Ä–∏ —É–¥–∞–ª–µ–Ω–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- ‚ö†Ô∏è –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å lifecycle policy –≤ Object Storage
- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å –ø–µ—Ä–∏–æ–¥–∏—á–µ—Å–∫—É—é –ø—Ä–æ–≤–µ—Ä–∫—É orphaned —Ñ–∞–π–ª–æ–≤

---

### üìâ –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥

#### 12. –ù–µ–¥–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è observability

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ë–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏**

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ù–µ—Ç –º–µ—Ç—Ä–∏–∫ –±–∏–∑–Ω–µ—Å-–ª–æ–≥–∏–∫–∏ (conversion rate, match rate, time to match)
- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç distributed tracing –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏
- –õ–æ–≥–∏ 7 –¥–Ω–µ–π ‚Äî —Å–ª–∏—à–∫–æ–º –º–∞–ª–æ –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏ –≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥:
  - Conversion rate (—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è ‚Üí –ø–µ—Ä–≤—ã–π –ª–∞–π–∫)
  - Match rate (–ª–∞–π–∫–∏ ‚Üí –º–∞—Ç—á–∏)
  - Time to match (–≤—Ä–µ–º—è –æ—Ç —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏ –¥–æ –ø–µ—Ä–≤–æ–≥–æ –º–∞—Ç—á–∞)
  - Daily active users (DAU)
- ‚ö†Ô∏è –ù–∞—Å—Ç—Ä–æ–∏—Ç—å distributed tracing (Yandex Trace –∏–ª–∏ OpenTelemetry)
- ‚ö†Ô∏è –£–≤–µ–ª–∏—á–∏—Ç—å retention –ª–æ–≥–æ–≤ –¥–æ 30 –¥–Ω–µ–π –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞ –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤

---

### üîê –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–∏—Å–∫–∏

#### 13. CORS –∏ credentials

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–¢—Ä–µ–±—É–µ—Ç —É—Ç–æ—á–Ω–µ–Ω–∏—è**

**–ü—Ä–æ–±–ª–µ–º–∞:**

- CORS –Ω–∞—Å—Ç—Ä–æ–µ–Ω –Ω–∞ `credentials: true`, –Ω–æ –Ω–µ —É–∫–∞–∑–∞–Ω–æ, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–∏ cookies
- –ï—Å–ª–∏ cookies –Ω–µ –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è, `credentials: true` –Ω–µ –Ω—É–∂–µ–Ω

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- ‚ö†Ô∏è –£—Ç–æ—á–Ω–∏—Ç—å, –∏—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è –ª–∏ cookies
- ‚ö†Ô∏è –ï—Å–ª–∏ –Ω–µ—Ç ‚Äî —É–±—Ä–∞—Ç—å `credentials: true` –¥–ª—è –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏

#### 14. Rate limiting

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ú–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∏–∑–∫–∏–º**

**–ü—Ä–æ–±–ª–µ–º–∞:**

- Rate limiting 100 req/15min –º–æ–∂–µ—Ç –±—ã—Ç—å –Ω–∏–∑–∫–∏–º –¥–ª—è –∞–∫—Ç–∏–≤–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ù–µ—Ç –¥–∏—Ñ—Ñ–µ—Ä–µ–Ω—Ü–∏–∞—Ü–∏–∏ –ø–æ —Ç–∏–ø–∞–º –∑–∞–ø—Ä–æ—Å–æ–≤

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- ‚ö†Ô∏è –£–≤–µ–ª–∏—á–∏—Ç—å –ª–∏–º–∏—Ç –¥–ª—è –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚ö†Ô∏è –†–∞–∑–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ç–∏–ø–æ–≤ –∑–∞–ø—Ä–æ—Å–æ–≤ (GET vs POST)
- ‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å sliding window –≤–º–µ—Å—Ç–æ fixed window

#### 15. API versioning

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–ü–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ**

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –û—Ç—Å—É—Ç—Å—Ç–≤—É–µ—Ç API versioning strategy
- –ß—Ç–æ –±—É–¥–µ—Ç –ø—Ä–∏ breaking changes?

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- ‚ö†Ô∏è –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é –≤–µ—Ä—Å–∏–æ–Ω–∏—Ä–æ–≤–∞–Ω–∏—è (URL path vs header)
- ‚ö†Ô∏è –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å –¥–µ–ø—Ä–µ–∫–∞—Ü–∏–∏ —Å—Ç–∞—Ä—ã—Ö –≤–µ—Ä—Å–∏–π
- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å –≤–µ—Ä—Å–∏—é –≤ –æ—Ç–≤–µ—Ç—ã API

#### 16. GDPR compliance

**–°—Ç–∞—Ç—É—Å:** ‚ö†Ô∏è **–Æ—Ä–∏–¥–∏—á–µ—Å–∫–∏–µ —Ç—Ä–µ–±–æ–≤–∞–Ω–∏—è**

**–ü—Ä–æ–±–ª–µ–º–∞:**

- –ù–µ—Ç —É–ø–æ–º–∏–Ω–∞–Ω–∏—è –æ GDPR compliance –¥–ª—è dating app
- –ù–µ—Ç –º–µ—Ö–∞–Ω–∏–∑–º–∞ —É–¥–∞–ª–µ–Ω–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è

**–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏:**

- ‚ö†Ô∏è –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å "right to be forgotten" (—É–¥–∞–ª–µ–Ω–∏–µ –≤—Å–µ—Ö –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è)
- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å consent management
- ‚ö†Ô∏è –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø–æ–ª–∏—Ç–∏–∫—É –∫–æ–Ω—Ñ–∏–¥–µ–Ω—Ü–∏–∞–ª—å–Ω–æ—Å—Ç–∏
- ‚ö†Ô∏è –î–æ–±–∞–≤–∏—Ç—å —ç–∫—Å–ø–æ—Ä—Ç –¥–∞–Ω–Ω—ã—Ö –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (GDPR data portability)

---

## üìã –ü–ª–∞–Ω –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏–π

### üî¥ –ö—Ä–∏—Ç–∏—á–Ω–æ –∏—Å–ø—Ä–∞–≤–∏—Ç—å —Å–µ–π—á–∞—Å (–¥–æ production)

1. **–í–Ω–µ–¥—Ä–∏—Ç—å Message Queue –¥–ª—è —É–≤–µ–¥–æ–º–ª–µ–Ω–∏–π**
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Yandex Message Queue
   - –ü–µ—Ä–µ–ø–∏—Å–∞—Ç—å `notifyBotAboutMatch()` –Ω–∞ –æ—Ç–ø—Ä–∞–≤–∫—É –≤ –æ—á–µ—Ä–µ–¥—å
   - –î–æ–±–∞–≤–∏—Ç—å consumer –≤ bot –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
   - –î–æ–±–∞–≤–∏—Ç—å retry –º–µ—Ö–∞–Ω–∏–∑–º

2. **–£–ª—É—á—à–∏—Ç—å Admin Auth**
   - –í–Ω–µ–¥—Ä–∏—Ç—å JWT —Ç–æ–∫–µ–Ω—ã
   - –î–æ–±–∞–≤–∏—Ç—å refresh token –º–µ—Ö–∞–Ω–∏–∑–º
   - –°–æ–∑–¥–∞—Ç—å —Ç–∞–±–ª–∏—Ü—É `admin_sessions` –≤ –ë–î
   - –î–æ–±–∞–≤–∏—Ç—å endpoint –¥–ª—è logout

3. **–î–æ–±–∞–≤–∏—Ç—å –±–∞–∑–æ–≤—ã–µ —Ç–µ—Å—Ç—ã**
   - Unit —Ç–µ—Å—Ç—ã –¥–ª—è –∫—Ä–∏—Ç–∏—á–Ω–æ–π –ª–æ–≥–∏–∫–∏
   - Integration —Ç–µ—Å—Ç—ã –¥–ª—è API endpoints
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å CI/CD –¥–ª—è —Ç–µ—Å—Ç–æ–≤

4. **–î–æ–±–∞–≤–∏—Ç—å —Å–æ—Å—Ç–∞–≤–Ω—ã–µ –∏–Ω–¥–µ–∫—Å—ã –≤ YDB**
   - –°–æ–∑–¥–∞—Ç—å –º–∏–≥—Ä–∞—Ü–∏—é –¥–ª—è `idx_user1_user2` –≤ matches
   - –î–æ–±–∞–≤–∏—Ç—å –∏–Ω–¥–µ–∫—Å—ã –¥–ª—è –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –∑–∞–ø—Ä–æ—Å–æ–≤

### ‚ö†Ô∏è –£–ª—É—á—à–∏—Ç—å –≤ –±–ª–∏–∂–∞–π—à–µ–µ –≤—Ä–µ–º—è (1-2 –Ω–µ–¥–µ–ª–∏)

5. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å proper cache invalidation –≤ React Query**
   - –î–æ–±–∞–≤–∏—Ç—å invalidation –ø–æ—Å–ª–µ –º—É—Ç–∞—Ü–∏–π
   - –†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å optimistic updates

6. **–í—ã–Ω–µ—Å—Ç–∏ –º–∏–≥—Ä–∞—Ü–∏–∏ –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π –ø—Ä–æ—Ü–µ—Å—Å**
   - –°–æ–∑–¥–∞—Ç—å –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–∫—Ä–∏–ø—Ç –¥–ª—è –º–∏–≥—Ä–∞—Ü–∏–π
   - –î–æ–±–∞–≤–∏—Ç—å –±–ª–æ–∫–∏—Ä–æ–≤–∫—É –¥–ª—è –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ–≥–æ –∑–∞–ø—É—Å–∫–∞

7. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å CDN –¥–ª—è Object Storage**
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å Yandex CDN
   - –î–æ–±–∞–≤–∏—Ç—å cache headers

8. **–î–æ–±–∞–≤–∏—Ç—å –±–∏–∑–Ω–µ—Å-–º–µ—Ç—Ä–∏–∫–∏ –≤ –º–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
   - Conversion rate, match rate, time to match
   - –ù–∞—Å—Ç—Ä–æ–∏—Ç—å –¥–∞—à–±–æ—Ä–¥—ã

### üìù –î–æ–ª–≥–æ—Å—Ä–æ—á–Ω—ã–µ —É–ª—É—á—à–µ–Ω–∏—è (1-2 –º–µ—Å—è—Ü–∞)

9. **–í—ã–Ω–µ—Å—Ç–∏ –æ–±—Ä–∞–±–æ—Ç–∫—É –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π –≤ –æ—Ç–¥–µ–ª—å–Ω—ã–π —Å–µ—Ä–≤–∏—Å**
   - Cloud Function –¥–ª—è –æ–±—Ä–∞–±–æ—Ç–∫–∏
   - Async queue

10. **–†–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å GDPR compliance**
    - Right to be forgotten
    - Data export
    - Consent management

11. **–ù–∞—Å—Ç—Ä–æ–∏—Ç—å distributed tracing**
    - OpenTelemetry –∏–ª–∏ Yandex Trace
    - –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –º–µ–∂–¥—É —Å–µ—Ä–≤–∏—Å–∞–º–∏

12. **–î–æ–±–∞–≤–∏—Ç—å API versioning**
    - –û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Å—Ç—Ä–∞—Ç–µ–≥–∏—é
    - –î–æ–∫—É–º–µ–Ω—Ç–∏—Ä–æ–≤–∞—Ç—å –ø—Ä–æ—Ü–µ—Å—Å

---

**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ:** 2024-12-02  
**–ê—É–¥–∏—Ç –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏:** 2024-12-02
