# ‚úÖ –ì–æ—Ç–æ–≤–Ω–æ—Å—Ç—å –∫ Production –¥–µ–ø–ª–æ—é

**–î–∞—Ç–∞:** 2024-12-XX  
**–°—Ç–∞—Ç—É—Å:** ‚úÖ –í—Å–µ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–∏–º–µ–Ω–µ–Ω—ã, –≥–æ—Ç–æ–≤–æ –∫ –¥–µ–ø–ª–æ—é

## üîß –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### 1. –ë–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç—å —Å–µ–∫—Ä–µ—Ç–æ–≤

- ‚úÖ –£–¥–∞–ª–µ–Ω—ã –≤—Å–µ —Ä–µ–∞–ª—å–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø—Ä–µ–¥—É–ø—Ä–µ–∂–¥–µ–Ω–∏—è –æ –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
- ‚úÖ –°–æ–∑–¥–∞–Ω—ã –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –ø–æ —É—Å—Ç—Ä–∞–Ω–µ–Ω–∏—é –ø–æ—Å–ª–µ–¥—Å—Ç–≤–∏–π —É—Ç–µ—á–µ–∫

### 2. –£—è–∑–≤–∏–º–æ—Å—Ç–∏ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–µ–π

- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `jspdf`: 2.5.2 ‚Üí 3.0.4
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `jspdf-autotable`: 3.8.4 ‚Üí 5.0.2
- ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω `multer`: 1.4.5-lts.1 ‚Üí 2.0.2
- ‚úÖ –í—Å–µ –∫—Ä–∏—Ç–∏—á–µ—Å–∫–∏–µ —É—è–∑–≤–∏–º–æ—Å—Ç–∏ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã

### 3. GitHub Workflows Permissions

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã `permissions` –≤–æ –≤—Å–µ workflow —Ñ–∞–π–ª—ã
- ‚úÖ –ü—Ä–∏–º–µ–Ω–µ–Ω –ø—Ä–∏–Ω—Ü–∏–ø –Ω–∞–∏–º–µ–Ω—å—à–∏—Ö –ø—Ä–∏–≤–∏–ª–µ–≥–∏–π

### 4. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ deploy.yml

#### Bug 1: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ exit –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ config.js

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `exit 1` –≤ staging "Deploy Admin" –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ config.js

#### Bug 2: –î—É–±–ª–∏—Ä—É—é—â–∏–π –±–ª–æ–∫ –∏ –æ—Ç—Å—É—Ç—Å—Ç–≤—É—é—â–∏–µ –ø–µ—Ä–µ–º–µ–Ω–Ω—ã–µ

- ‚úÖ –£–¥–∞–ª–µ–Ω –¥—É–±–ª–∏—Ä—É—é—â–∏–π `elif` –±–ª–æ–∫ –≤ production backend deployment
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã `ADMIN_USERNAME`, `ADMIN_PASSWORD`, `ADMIN_TOKEN` –≤–æ –≤—Å–µ –ø—É—Ç–∏ –¥–µ–ø–ª–æ—è

#### Bug 3: –û—Ç—Å—É—Ç—Å—Ç–≤–∏–µ exit –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ BACKEND_URL

- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω `exit 1` –≤ staging "Get Backend URL for Admin Config"
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ `null` –∑–Ω–∞—á–µ–Ω–∏–µ

#### Bug 4: –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è

- ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ "Run database migrations"
- ‚úÖ –ü–µ—Ä–µ–º–µ–Ω–Ω—ã–µ —Ç–µ–ø–µ—Ä—å –Ω–∞ –æ–¥–Ω–æ–π —Å—Ç—Ä–æ–∫–µ —Å –∫–æ–º–∞–Ω–¥–æ–π npm

### 5. –ò—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è –≤ deploy-backend.yml

#### Bug 5: –£—Å–ø–µ—à–Ω—ã–π exit –ø—Ä–∏ –æ—Ç—Å—É—Ç—Å—Ç–≤–∏–∏ CONTAINER_URL

- ‚úÖ –ó–∞–º–µ–Ω–µ–Ω `exit 0` –Ω–∞ `exit 1` –≤ "Get Container URL" (staging –∏ production)
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω–∞ –ø—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞ –ø—É—Å—Ç–æ–µ –∏–ª–∏ `null` –∑–Ω–∞—á–µ–Ω–∏–µ
- ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã –ø–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

## üìã –ß–µ–∫–ª–∏—Å—Ç –ø–µ—Ä–µ–¥ –¥–µ–ø–ª–æ–µ–º

### GitHub Secrets

–£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Å–µ–∫—Ä–µ—Ç—ã –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã:

- [ ] `YC_SERVICE_ACCOUNT_KEY`
- [ ] `YC_CLOUD_ID`
- [ ] `YC_FOLDER_ID`
- [ ] `YC_CONTAINER_ID_PROD`
- [ ] `YC_REGISTRY_ID`
- [ ] `TELEGRAM_BOT_TOKEN_PROD`
- [ ] `YDB_ENDPOINT_PROD`
- [ ] `YDB_DATABASE_PROD`
- [ ] `YANDEX_STORAGE_BUCKET_PROD`
- [ ] `YANDEX_STORAGE_ACCESS_KEY_PROD`
- [ ] `YANDEX_STORAGE_SECRET_KEY_PROD`
- [ ] `ADMIN_STORAGE_BUCKET_PROD`
- [ ] `ADMIN_STORAGE_ACCESS_KEY_PROD`
- [ ] `ADMIN_STORAGE_SECRET_KEY_PROD`
- [ ] `ALLOWED_ORIGINS_PROD`
- [ ] `ADMIN_ORIGINS_PROD`
- [ ] `ADMIN_USERNAME_PROD` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] `ADMIN_PASSWORD_PROD` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] `ADMIN_TOKEN_PROD` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] `TELEGRAM_ALERT_BOT_TOKEN` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)
- [ ] `TELEGRAM_ALERT_CHAT_ID` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ)

### Environments

- [ ] –°–æ–∑–¥–∞–Ω environment `production` –≤ GitHub
- [ ] –ù–∞—Å—Ç—Ä–æ–µ–Ω—ã deployment branches (—Ç–æ–ª—å–∫–æ `main`)

### –õ–æ–∫–∞–ª—å–Ω–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

- [ ] –í—Å–µ –∏–∑–º–µ–Ω–µ–Ω–∏—è –∑–∞–∫–æ–º–º–∏—á–µ–Ω—ã
- [ ] –í–µ—Ç–∫–∞ —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä–æ–≤–∞–Ω–∞ —Å —É–¥–∞–ª–µ–Ω–Ω—ã–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º
- [ ] –ù–µ—Ç –Ω–µ–∑–∞–∫–æ–º–º–∏—á–µ–Ω–Ω—ã—Ö –∏–∑–º–µ–Ω–µ–Ω–∏–π

## üöÄ –ó–∞–ø—É—Å–∫ –¥–µ–ø–ª–æ—è

### –í–∞—Ä–∏–∞–Ω—Ç 1: –ß–µ—Ä–µ–∑ git push (–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–π)

```bash
# –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—ã –Ω–∞ –≤–µ—Ç–∫–µ main
git checkout main

# –°–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É–π—Ç–µ —Å —É–¥–∞–ª–µ–Ω–Ω—ã–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–µ–º
git pull origin main

# –°–æ–∑–¥–∞–π—Ç–µ –∫–æ–º–º–∏—Ç (–µ—Å–ª–∏ –µ—Å—Ç—å –∏–∑–º–µ–Ω–µ–Ω–∏—è)
git add .
git commit -m "chore: apply security fixes and workflow improvements"

# –ó–∞–ø—É—à—å—Ç–µ –≤ main - —ç—Ç–æ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–ø—É—Å—Ç–∏—Ç production –¥–µ–ø–ª–æ–π
git push origin main
```

### –í–∞—Ä–∏–∞–Ω—Ç 2: –ß–µ—Ä–µ–∑ GitHub UI (—Ä—É—á–Ω–æ–π –∑–∞–ø—É—Å–∫)

1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ GitHub ‚Üí Actions
2. –í—ã–±–µ—Ä–∏—Ç–µ workflow "Deploy to Yandex Cloud"
3. –ù–∞–∂–º–∏—Ç–µ "Run workflow"
4. –í—ã–±–µ—Ä–∏—Ç–µ –≤–µ—Ç–∫—É `main`
5. –ù–∞–∂–º–∏—Ç–µ "Run workflow"

## üìä –ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥ –¥–µ–ø–ª–æ—è

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –¥–µ–ø–ª–æ—è:

1. **–û—Ç–∫—Ä–æ–π—Ç–µ GitHub Actions:**
   - https://github.com/vidmichd-lab/lug-date/actions
   - –ù–∞–π–¥–∏—Ç–µ –∑–∞–ø—É—â–µ–Ω–Ω—ã–π workflow "Deploy to Yandex Cloud"

2. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∫–∞–∂–¥—ã–π —à–∞–≥:**
   - ‚úÖ `test` - —Ç–µ—Å—Ç—ã –¥–æ–ª–∂–Ω—ã –ø—Ä–æ–π—Ç–∏
   - ‚úÖ `deploy-production` - –≤—Å–µ —à–∞–≥–∏ –¥–æ–ª–∂–Ω—ã –≤—ã–ø–æ–ª–Ω–∏—Ç—å—Å—è —É—Å–ø–µ—à–Ω–æ

3. **–ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏:**
   - –ï—Å–ª–∏ –∫–∞–∫–æ–π-—Ç–æ —à–∞–≥ —É–ø–∞–ª, –ø—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏
   - –í—Å–µ –æ—à–∏–±–∫–∏ —Ç–µ–ø–µ—Ä—å –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è–º–∏

## üîç –ü—Ä–æ–≤–µ—Ä–∫–∞ –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è

### Backend

```bash
# –ü–æ–ª—É—á–∏—Ç–µ URL –∫–æ–Ω—Ç–µ–π–Ω–µ—Ä–∞ –∏–∑ –ª–æ–≥–æ–≤ –∏–ª–∏ Yandex Cloud Console
curl https://<container-url>/health
```

### Frontend

```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
https://<bucket-name>.website.yandexcloud.net/
```

### Admin

```bash
# –û—Ç–∫—Ä–æ–π—Ç–µ –≤ –±—Ä–∞—É–∑–µ—Ä–µ
https://<admin-bucket-name>.website.yandexcloud.net/
```

## ‚ö†Ô∏è –í–∞–∂–Ω—ã–µ –∑–∞–º–µ—á–∞–Ω–∏—è

1. **–°–µ–∫—Ä–µ—Ç—ã:** –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ —Å—Ç–∞—Ä—ã–µ —Å–∫–æ–º–ø—Ä–æ–º–µ—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ —Å–µ–∫—Ä–µ—Ç—ã –æ—Ç–æ–∑–≤–∞–Ω—ã –∏ –∑–∞–º–µ–Ω–µ–Ω—ã –Ω–æ–≤—ã–º–∏
2. **–ú–∏–≥—Ä–∞—Ü–∏–∏:** –ú–∏–≥—Ä–∞—Ü–∏–∏ –±–∞–∑—ã –¥–∞–Ω–Ω—ã—Ö –≤—ã–ø–æ–ª–Ω—è—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ –¥–µ–ø–ª–æ–µ
3. **Health checks:** Backend –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–æ–≤–µ—Ä—è–µ—Ç—Å—è –Ω–∞ –¥–æ—Å—Ç—É–ø–Ω–æ—Å—Ç—å –ø–æ—Å–ª–µ –¥–µ–ø–ª–æ—è
4. **–û—à–∏–±–∫–∏:** –í—Å–µ –æ—à–∏–±–∫–∏ —Ç–µ–ø–µ—Ä—å –æ—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç –¥–µ–ø–ª–æ–π —Å –ø–æ–Ω—è—Ç–Ω—ã–º–∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏

## üìù –ß—Ç–æ –±—ã–ª–æ –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–æ –≤ —ç—Ç–æ–π —Å–µ—Å—Å–∏–∏

1. ‚úÖ –£–¥–∞–ª–µ–Ω—ã —Å–µ–∫—Ä–µ—Ç–Ω—ã–µ –∫–ª—é—á–∏ Yandex Cloud –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
2. ‚úÖ –£–¥–∞–ª–µ–Ω—ã Telegram Bot Tokens –∏–∑ –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏–∏
3. ‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω—ã —É—è–∑–≤–∏–º—ã–µ npm –ø–∞–∫–µ—Ç—ã (jspdf, multer)
4. ‚úÖ –î–æ–±–∞–≤–ª–µ–Ω—ã permissions –≤–æ –≤—Å–µ GitHub workflows
5. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –±–∞–≥–∏ –≤ deploy.yml (config.js, –¥—É–±–ª–∏—Ä—É—é—â–∏–π –±–ª–æ–∫, BACKEND_URL)
6. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –±–∞–≥–∏ –≤ deploy-backend.yml (CONTAINER_URL)
7. ‚úÖ –ò—Å–ø—Ä–∞–≤–ª–µ–Ω —Å–∏–Ω—Ç–∞–∫—Å–∏—Å –ø–µ—Ä–µ–º–µ–Ω–Ω—ã—Ö –æ–∫—Ä—É–∂–µ–Ω–∏—è –≤ –º–∏–≥—Ä–∞—Ü–∏—è—Ö

---

**–ì–æ—Ç–æ–≤–æ –∫ production –¥–µ–ø–ª–æ—é!** üöÄ
