# –ü—Ä–æ–≤–µ—Ä–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ GitHub

–≠—Ç–æ—Ç –¥–æ–∫—É–º–µ–Ω—Ç –ø–æ–º–æ–∂–µ—Ç –ø—Ä–æ–≤–µ—Ä–∏—Ç—å, —á—Ç–æ –≤—Å–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–æ –ø—Ä–∞–≤–∏–ª—å–Ω–æ –¥–ª—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–≥–æ –¥–µ–ø–ª–æ—è.

## ‚úÖ –ß–µ–∫–ª–∏—Å—Ç –ø—Ä–æ–≤–µ—Ä–∫–∏

### 1. –ü—Ä–æ–≤–µ—Ä–∫–∞ Secrets

–û—Ç–∫—Ä–æ–π—Ç–µ: **https://github.com/vidmichd-lab/lug-date/settings/secrets/actions**

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- [ ] –°–µ–∫—Ä–µ—Ç `YC_SERVICE_ACCOUNT_KEY` —Å–æ–∑–¥–∞–Ω
- [ ] –ó–Ω–∞—á–µ–Ω–∏–µ —Å–∫—Ä—ã—Ç–æ (–ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç—Å—è –∫–∞–∫ `‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢‚Ä¢`)
- [ ] –ò–º—è —Ç–æ—á–Ω–æ `YC_SERVICE_ACCOUNT_KEY` (–±–µ–∑ –ø—Ä–æ–±–µ–ª–æ–≤, —Ä–µ–≥–∏—Å—Ç—Ä –≤–∞–∂–µ–Ω)

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –≤—ã—à–µ
2. –í —Å–ø–∏—Å–∫–µ —Å–µ–∫—Ä–µ—Ç–æ–≤ –¥–æ–ª–∂–µ–Ω –±—ã—Ç—å `YC_SERVICE_ACCOUNT_KEY`
3. –ï—Å–ª–∏ –µ–≥–æ –Ω–µ—Ç - —Å–æ–∑–¥–∞–π—Ç–µ –ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ [GITHUB_SETUP.md](GITHUB_SETUP.md)

### 2. –ü—Ä–æ–≤–µ—Ä–∫–∞ Environments

–û—Ç–∫—Ä–æ–π—Ç–µ: **https://github.com/vidmichd-lab/lug-date/settings/environments**

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- [ ] Environment `staging` —Å–æ–∑–¥–∞–Ω
- [ ] Environment `production` —Å–æ–∑–¥–∞–Ω
- [ ] `production` –∏–º–µ–µ—Ç –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–µ –Ω–∞ –≤–µ—Ç–∫—É `main` (–æ–ø—Ü–∏–æ–Ω–∞–ª—å–Ω–æ, –Ω–æ —Ä–µ–∫–æ–º–µ–Ω–¥—É–µ—Ç—Å—è)

**–ö–∞–∫ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å:**
1. –ü–µ—Ä–µ–π–¥–∏—Ç–µ –ø–æ —Å—Å—ã–ª–∫–µ –≤—ã—à–µ
2. –í —Å–ø–∏—Å–∫–µ environments –¥–æ–ª–∂–Ω—ã –±—ã—Ç—å `staging` –∏ `production`
3. –ï—Å–ª–∏ –∏—Ö –Ω–µ—Ç - —Å–æ–∑–¥–∞–π—Ç–µ –ø–æ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –≤ [GITHUB_SETUP.md](GITHUB_SETUP.md)

### 3. –ü—Ä–æ–≤–µ—Ä–∫–∞ Workflow —Ñ–∞–π–ª–∞

–§–∞–π–ª: `.github/workflows/deploy.yml`

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ —Ñ–∞–π–ª —Å–æ–¥–µ—Ä–∂–∏—Ç:

#### –î–ª—è staging:
```yaml
environment:
  name: staging
```

#### –î–ª—è production:
```yaml
environment:
  name: production
```

#### –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ —Å–µ–∫—Ä–µ—Ç–∞:
```yaml
yc-sa-json-credentials: ${{ secrets.YC_SERVICE_ACCOUNT_KEY }}
```

**–¢–µ–∫—É—â–∏–π —Å—Ç–∞—Ç—É—Å:** ‚úÖ Workflow —Ñ–∞–π–ª –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–∞–≤–∏–ª—å–Ω–æ

### 4. –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ GitHub Actions

–û—Ç–∫—Ä–æ–π—Ç–µ: **https://github.com/vidmichd-lab/lug-date/actions**

–ü—Ä–æ–≤–µ—Ä—å—Ç–µ:
- [ ] Workflow "Deploy to Yandex Cloud" –≤–∏–¥–µ–Ω –≤ —Å–ø–∏—Å–∫–µ
- [ ] –ü—Ä–∏ –ø—É—à–µ –≤ `develop` –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è deploy-staging
- [ ] –ü—Ä–∏ –ø—É—à–µ –≤ `main` –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è deploy-production

**–ö–∞–∫ –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞—Ç—å:**

1. **–¢–µ—Å—Ç staging:**
   ```bash
   git checkout develop
   git commit --allow-empty -m "test: –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ø–ª–æ—è staging"
   git push
   ```
   
   –ó–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - https://github.com/vidmichd-lab/lug-date/actions
   - –î–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è workflow
   - Job "Deploy to Staging" –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å environment `staging`

2. **–¢–µ—Å—Ç production:**
   ```bash
   git checkout main
   git commit --allow-empty -m "test: –ø—Ä–æ–≤–µ—Ä–∫–∞ –¥–µ–ø–ª–æ—è production"
   git push
   ```
   
   –ó–∞—Ç–µ–º –ø—Ä–æ–≤–µ—Ä—å—Ç–µ:
   - https://github.com/vidmichd-lab/lug-date/actions
   - –î–æ–ª–∂–µ–Ω –∑–∞–ø—É—Å—Ç–∏—Ç—å—Å—è workflow
   - Job "Deploy to Production" –¥–æ–ª–∂–µ–Ω –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å environment `production`

## üîç –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø—Ä–æ–≤–µ—Ä–∫–∞

–ï—Å–ª–∏ —É –≤–∞—Å —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω GitHub CLI:

```bash
# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å GitHub CLI (–µ—Å–ª–∏ –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω)
brew install gh

# –ê–≤—Ç–æ—Ä–∏–∑–æ–≤–∞—Ç—å—Å—è
gh auth login

# –ó–∞–ø—É—Å—Ç–∏—Ç—å –ø—Ä–æ–≤–µ—Ä–∫—É
./scripts/verify-github-setup.sh
```

## ‚ùå –í–æ–∑–º–æ–∂–Ω—ã–µ –ø—Ä–æ–±–ª–µ–º—ã

### –ü—Ä–æ–±–ª–µ–º–∞: "Secret not found" –≤ –ª–æ–≥–∞—Ö GitHub Actions

**–ü—Ä–∏—á–∏–Ω–∞:** –°–µ–∫—Ä–µ—Ç –Ω–µ —Å–æ–∑–¥–∞–Ω –∏–ª–∏ –∏–º–µ–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º—è —Å–µ–∫—Ä–µ—Ç–∞: –¥–æ–ª–∂–Ω–æ –±—ã—Ç—å —Ç–æ—á–Ω–æ `YC_SERVICE_ACCOUNT_KEY`
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ–∫—Ä–µ—Ç —Å–æ–∑–¥–∞–Ω –Ω–∞ —É—Ä–æ–≤–Ω–µ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏—è (–Ω–µ environment)
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—ã –Ω–∞—Ö–æ–¥–∏—Ç–µ—Å—å –≤ –ø—Ä–∞–≤–∏–ª—å–Ω–æ–º —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–∏

### –ü—Ä–æ–±–ª–µ–º–∞: "Environment not found" –≤ –ª–æ–≥–∞—Ö GitHub Actions

**–ü—Ä–∏—á–∏–Ω–∞:** Environment –Ω–µ —Å–æ–∑–¥–∞–Ω –∏–ª–∏ –∏–º–µ–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∏–º—è.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –∏–º–µ–Ω–∞ environments –≤ `.github/workflows/deploy.yml`:
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å `environment: staging` –¥–ª—è staging
   - –î–æ–ª–∂–Ω–æ –±—ã—Ç—å `environment: production` –¥–ª—è production
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ environments —Å–æ–∑–¥–∞–Ω—ã –≤ Settings ‚Üí Environments

### –ü—Ä–æ–±–ª–µ–º–∞: "Invalid JSON credentials"

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π —Ñ–æ—Ä–º–∞—Ç JSON –≤ YC_SERVICE_ACCOUNT_KEY.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ JSON –≤–∞–ª–∏–¥–Ω—ã–π (–º–æ–∂–Ω–æ –ø—Ä–æ–≤–µ—Ä–∏—Ç—å –Ω–∞ jsonlint.com)
2. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–∫–æ–ø–∏—Ä–æ–≤–∞–Ω –≤–µ—Å—å —Ñ–∞–π–ª —Ü–µ–ª–∏–∫–æ–º
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –Ω–µ—Ç –ª–∏—à–Ω–∏—Ö –ø—Ä–æ–±–µ–ª–æ–≤ –∏–ª–∏ —Å–∏–º–≤–æ–ª–æ–≤ –≤ –Ω–∞—á–∞–ª–µ/–∫–æ–Ω—Ü–µ
4. –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –ø–æ–ª—è –ø—Ä–∏—Å—É—Ç—Å—Ç–≤—É—é—Ç (id, service_account_id, private_key –∏ —Ç.–¥.)

### –ü—Ä–æ–±–ª–µ–º–∞: Workflow –Ω–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

**–ü—Ä–∏—á–∏–Ω–∞:** –ù–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–µ —É—Å–ª–æ–≤–∏—è –≤ workflow –∏–ª–∏ –ø—Ä–æ–±–ª–µ–º—ã —Å –≤–µ—Ç–∫–∞–º–∏.

**–†–µ—à–µ–Ω–∏–µ:**
1. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ –≤—ã –ø—É—à–∏—Ç–µ –≤ –ø—Ä–∞–≤–∏–ª—å–Ω—É—é –≤–µ—Ç–∫—É:
   - `develop` ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç staging
   - `main` ‚Üí –∑–∞–ø—É—Å–∫–∞–µ—Ç production
2. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ, —á—Ç–æ workflow —Ñ–∞–π–ª –Ω–∞—Ö–æ–¥–∏—Ç—Å—è –≤ `.github/workflows/deploy.yml`
3. –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–∏–Ω—Ç–∞–∫—Å–∏—Å YAML —Ñ–∞–π–ª–∞

## üìä –°—Ç–∞—Ç—É—Å –ø—Ä–æ–≤–µ—Ä–∫–∏

–ü–æ—Å–ª–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏—è –≤—Å–µ—Ö –ø—Ä–æ–≤–µ—Ä–æ–∫, –æ—Ç–º–µ—Ç—å—Ç–µ —Å—Ç–∞—Ç—É—Å:

- [ ] Secrets –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] Environments –Ω–∞—Å—Ç—Ä–æ–µ–Ω—ã
- [ ] Workflow —Ñ–∞–π–ª –∫–æ—Ä—Ä–µ–∫—Ç–µ–Ω
- [ ] –¢–µ—Å—Ç–æ–≤—ã–π –¥–µ–ø–ª–æ–π staging –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ
- [ ] –¢–µ—Å—Ç–æ–≤—ã–π –¥–µ–ø–ª–æ–π production –ø—Ä–æ—à–µ–ª —É—Å–ø–µ—à–Ω–æ

## üìñ –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω–∞—è –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è

- [–ü–æ–¥—Ä–æ–±–Ω–∞—è –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –Ω–∞—Å—Ç—Ä–æ–π–∫–µ](GITHUB_SETUP.md)
- [GitHub Actions Documentation](https://docs.github.com/en/actions)
- [GitHub Environments](https://docs.github.com/en/actions/deployment/targeting-different-environments/using-environments-for-deployment)



